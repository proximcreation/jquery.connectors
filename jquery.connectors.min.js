(function(a){a.fn.connect=function(g,b,i,j,e,c){var f=a("body").css("position");if(f=="static"){a("body").css("position","relative")}var h=this;var d=(h.equals(g))?true:false;h.each(function(k){var l=a(this);g.each(function(m){a(this).connectTo(l,b,i,j,true,e,c)});if(d){h=h.not(l);g=h}});return this};a.fn.connectTo=function(o,q,f,h,i,m,k){var p=this;if(!p.equals(o)){var d=browser();var c="con_"+(a(".connector").size()+1*1);a("body").append('<div class="connector '+c+'"></div>');var b=a("."+c);if(!m){var m={x:0,y:0}}else{m.x=(m.x)?m.x:0;m.y=(m.y)?m.y:0}if(!k){var k={x:0,y:0}}else{k.x=(k.x)?k.x:0;k.y=(k.y)?k.y:0}if(!i){var u=a("body").css("position");if(u=="static"){a("body").css("position","relative")}}var x={h:p.realHeight(),w:p.realWidth(),x:p.findPos().x*1+p.realWidth()/2+m.x*1,y:p.findPos().y*1+p.realHeight()/2+m.y*1};var t={h:o.realHeight(),w:o.realWidth(),x:o.findPos().x*1+o.realWidth()/2+k.x*1,y:o.findPos().y*1+o.realHeight()/2+k.y*1};var n=dist(x,t);if(f=="direct"){for(v in q){b.css(v,q[v])}b.css({width:n.d+"px",position:"absolute"});var e=b.realHeight();var w=b.realWidth();if(browser()[0]=="MSIE"&&browser()[1]<9){var j=x.y-e/2;var l=x.x;b.css("zoom","1");rotateIE(b,n.ad)}else{var j=(x.y*1+t.y*1)/2-e/2;var l=(x.x+t.x-w)/2;b.css({transform:"rotate("+n.ad+"deg)","-moz-transform":"rotate("+n.ad+"deg)","-webkit-transform":"rotate("+n.ad+"deg)","-o-transform":"rotate("+n.ad+"deg)","-ms-transform":"rotate("+n.ad+"deg)"})}b.css({top:j+"px",left:l+"px",})}else{if(f=="indirect"){b.append('<div class="scon1"></div>');b.append('<div class="scon2"></div>');scons=b.find(a(".scon1, .scon2"));scon1=b.find(a(".scon1"));scon2=b.find(a(".scon2"));for(v in q){scons.css(v,q[v])}var w=Math.abs(n.dx)*1-b.wPlus()*1+scon2.wPlus()/2;var e=Math.abs(n.dy)*1-b.hPlus()*1+scon2.hPlus()/2;var s=Math.min(x.x,t.x)-scon2.wPlus()/4;var r=Math.min(x.y,t.y)-scon2.hPlus()/4;b.css({width:w+"px",height:e+"px",position:"absolute",top:r,left:s});if(((x.y>=t.y)&&(x.x>=t.x))||((x.y<t.y)&&(x.x<t.x))){scon1.css({top:0,left:0,"border-bottom":"none","border-left":"none","border-bottom-left-radius":0,"border-bottom-right-radius":0,"border-top-left-radius":0});scon2.css({bottom:0,right:0,"border-top":"none","border-right":"none","border-top-left-radius":0,"border-top-right-radius":0,"border-bottom-right-radius":0})}else{scon1.css({bottom:0,left:0,"border-top":"none","border-left":"none","border-top-left-radius":0,"border-top-right-radius":0,"border-bottom-left-radius":0});scon2.css({top:0,right:0,"border-bottom":"none","border-right":"none","border-bottom-left-radius":0,"border-bottom-right-radius":0,"border-top-right-radius":0})}var g=(h!=undefined)?h:0.5;scon1.css({position:"absolute",width:w*g-scon1.wPlus()/2+"px",height:e*g-scon1.hPlus()/2+"px",});scon2.css({position:"absolute",width:w*(1-g)-scon2.wPlus()/2+"px",height:e*(1-g)-scon2.hPlus()/2+"px",})}}}return this};a.fn.realWidth=function(){return this.width()*1+this.wPlus()*1};a.fn.realHeight=function(){return this.height()*1+this.hPlus()*1};a.fn.wPlus=function(){var d=this.padding(),c=this.border();return d.left*1+d.right*1+c.left*1+c.right*1};a.fn.hPlus=function(){var d=this.padding(),c=this.border();return d.top*1+d.bottom*1+c.top*1+c.bottom*1};a.fn.findPos=function(){obj=this.get(0);var c=obj.offsetLeft||0;var b=obj.offsetTop||0;while(obj=obj.offsetParent){c+=obj.offsetLeft||0;b+=obj.offsetTop||0}return{x:c,y:b}};a.fn.padding=function(b){if(!b){return{top:parseFloat(this.css("padding-top")),bottom:parseFloat(this.css("padding-bottom")),left:parseFloat(this.css("padding-left")),right:parseFloat(this.css("padding-right"))}}else{this.css({"padding-top":b.top,"padding-right":b.right,"padding-bottom":b.bottom,"padding-left":b.left});return this}};a.fn.border=function(b){if(!b){return{top:parseFloat(this.css("border-top-width")),bottom:parseFloat(this.css("border-bottom-width")),left:parseFloat(this.css("border-left-width")),right:parseFloat(this.css("border-right-width"))}}else{this.css({"border-top-width":b.top,"border-right-width":b.right,"border-bottom-width":b.bottom,"border-left-width":b.left});return this}};a.fn.equals=function(b){if(!b||this.length!=b.length){return false}for(var c=0;c<this.length;++c){if(this[c]!==b[c]){return false}}return true}})(jQuery);function dist(b,g){var e=b.x-g.x;var d=b.y-g.y;var f=Math.sqrt(Math.pow(e,2)*1+Math.pow(d,2)*1);var c=Math.atan(d/e);return{d:f,dx:e,dy:d,ad:180*c/Math.PI,ar:c}}function rotateIE(d,c){var a=Math.PI*2/360;var b=c*a;lCostheta=Math.cos(b);lSintheta=Math.sin(b);d.css("filter","progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand',M11="+lCostheta+",M12="+-lSintheta+",M21="+lSintheta+",M22="+lCostheta+")");d.css("-ms-filter","progid:DXImageTransform.Microsoft.Matrix(M11="+lCostheta+",M12="+-lSintheta+",M21="+lSintheta+",M22="+lCostheta+",sizingMethod='auto expand')")}function browser(){var c=navigator.appName,b=navigator.userAgent,a;var d=b.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);if(d&&(a=b.match(/version\/([\.\d]+)/i))!=null){d[2]=a[1]}d=d?[d[1],d[2]]:[c,navigator.appVersion,"-?"];return d};
